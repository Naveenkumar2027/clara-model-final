{
  "meta": {
    "project": "AI-STUDIO (Clara Unified Monorepo)",
    "date": "2025-11-04",
    "prepared_by": "Software Development Manager"
  },
  "product_overview": "AI-STUDIO is a unified monorepo platform integrating client and staff interfaces for real-time video calls, AI assistance, and comprehensive staff and schedule management. It provides secure JWT authentication, multi-language voice recognition, WebRTC video calls, and AI chat powered by Google Gemini, all wrapped in a scalable, production-grade backend with a fiber-fast React frontend.",
  "core_goals": [
    "Enable secure and seamless real-time video communication between clients and staff using WebRTC and Socket.IO.",
    "Provide AI-powered conversational assistant and multi-language voice recognition for enhanced user experience.",
    "Offer robust staff management, availability querying, and timetable scheduling features with real-time updates.",
    "Ensure secure access with JWT-based authentication and role-based authorization.",
    "Implement a scalable and production-grade backend including database persistence, rate limiting, and health checks.",
    "Deliver user-friendly UI with permission handling, notifications, and smooth call lifecycle management.",
    "Create a resilient system with preventive encoding fixes, server health checks, and error handling."
  ],
  "key_features": [
    "JWT-based Authentication & Authorization with token refresh and role-based access control.",
    "Real-time Audio Recognition with microphone capture, PCM encoding, and streaming to Google Gemini AI.",
    "Multi-language Detection and Text-to-Speech with language-specific voices.",
    "WebRTC Video Calling with signaling via Socket.IO, SDP/ICE exchange, and call lifecycle management.",
    "Faculty Timetable and Schedule Management with real-time update via Socket.IO.",
    "Natural Language Availability Query System with fuzzy matching and live schedule checks.",
    "Campus Location Navigation with floor map support and direction guidance.",
    "Staff Directory and Skill-based Filtering with availability tracking.",
    "Real-time Notification System with read/unread states and socket delivery.",
    "AI-Powered Chat Assistant for college-related queries using Google Gemini AI.",
    "Meeting and Task Management with localStorage persistence and summarization.",
    "Device Permission Management for camera and microphone with selection UI.",
    "Comprehensive Error Handling, Logging, and Security with rate limiting and CORS.",
    "Health Check Endpoints and Server Monitoring utilities."
  ],
  "user_flow_summary": [
    "User authentication and login via JWT with visual feedback for server readiness.",
    "Client initiates WebRTC video call to staff member, signaling through Socket.IO events, including call initiate, accept, decline, and timeout handling.",
    "Staff receives incoming call notifications with UI popups to accept or decline, manage media streams, and perform call controls.",
    "Users interact with AI chat assistant for campus information and FAQs powered by Google Gemini AI.",
    "Staff manage and update their personal timetables and availability, triggering real-time schedule updates across system.",
    "Users send natural language availability queries for faculty, receiving real-time answers with fuzzy matching.",
    "Staff and clients receive real-time notifications on events like calls, meetings, and tasks with sync and read management.",
    "Users navigate campus locations with visual floor maps and directions.",
    "Meeting scheduling and task management flows with persistence and summary features.",
    "Microphone and camera permission workflows with device selection prompts and error handling."
  ],
  "validation_criteria": [
    "JWT authentication must enforce token refresh and role-based access control correctly.",
    "WebRTC calls establish peer connections reliably with proper signaling events and timeout management.",
    "Multi-language audio recognition and TTS function with confidence scoring as per supported languages.",
    "Staff timetable updates propagate correctly and validate workloads and conflicts.",
    "Availability queries return accurate, real-time timetable info with fuzzy matching of names.",
    "AI chat assistant responds appropriately to user queries related to campus and general info.",
    "Real-time notifications deliver and sync across clients and staff interfaces with read status management.",
    "Device permission prompts must handle denials and changes gracefully with user feedback.",
    "Server health check mechanism must prevent premature API calls and provide UI readiness feedback.",
    "Encoding fixes prevent any BOM-related build errors and enforce UTF-8 encoding via editor configs and scripts.",
    "Rate limiting must restrict abusive requests on key API endpoints effectively.",
    "Critical components must handle errors and log incidents for debugging with user-friendly messages.",
    "Testing coverage exists for backend API, WebRTC flows, socket events, and frontend state management.",
    "System works seamlessly with fallback for optional PostgreSQL database to in-memory store.",
    "The unified mode toggle fully enables/disables the integrated client-staff-server experience without breaking existing client-only use."
  ],
  "code_summary": {
    "tech_stack": [
      "TypeScript",
      "JavaScript",
      "React",
      "Express.js",
      "Node.js",
      "PostgreSQL",
      "Socket.IO",
      "WebRTC",
      "Google Gemini AI",
      "Vite",
      "Vitest",
      "Zod",
      "date-fns-tz",
      "Zustand",
      "Framer Motion",
      "React Router"
    ],
    "features": [
      {
        "name": "Authentication & Authorization",
        "description": "JWT-based authentication system with token refresh, staff login, and role-based access control",
        "files": [
          "apps/server/src/index.ts",
          "apps/staff/components/Login.tsx",
          "apps/staff/components/ProtectedRoute.tsx"
        ]
      },
      {
        "name": "Audio Recognition & Speech Processing",
        "description": "Real-time audio capture from microphone, PCM encoding, silence detection, and streaming to Gemini AI for speech-to-text",
        "files": [
          "apps/client/index.tsx",
          "apps/client/src/hooks/useMicrophone.ts",
          "apps/client/src/hooks/useAudio.ts"
        ]
      },
      {
        "name": "Language Detection & TTS",
        "description": "Multi-language detection (English, Telugu, Hindi, Tamil, Kannada, Malayalam) with confidence scoring, and text-to-speech with language-specific voices",
        "files": [
          "apps/client/index.tsx"
        ]
      },
      {
        "name": "Video Call/WebRTC",
        "description": "WebRTC-based video calling with signaling via Socket.IO, SDP/ICE exchange, peer connection management, and call lifecycle handling",
        "files": [
          "apps/client/src/services/CallService.ts",
          "apps/client/src/components/WebRTCVideoCall.tsx",
          "apps/client/src/components/CallRoom.tsx",
          "apps/client/src/components/InCallControls.tsx",
          "apps/server/src/routes/calls.ts",
          "packages/webrtc/src/index.ts"
        ]
      },
      {
        "name": "Faculty Schedule Management",
        "description": "Faculty timetable management system with schedule validation, workload calculation, edit history, and real-time updates via Socket.IO",
        "files": [
          "apps/server/src/index.ts",
          "apps/server/src/timetableRepository.ts",
          "apps/staff/components/Timetable.tsx",
          "apps/staff/services/timetableApi.ts",
          "packages/shared-schedule/src/store.ts",
          "packages/shared-schedule/src/schema.ts"
        ]
      },
      {
        "name": "Availability Query System",
        "description": "Natural language query system for faculty availability with fuzzy name matching, real-time availability checks, and schedule queries",
        "files": [
          "apps/client/src/services/availabilityQueryHandler.ts",
          "apps/server/src/routes/faculty.ts",
          "packages/shared-schedule/src/availability.ts",
          "packages/shared-schedule/src/utils/name-matching.ts"
        ]
      },
      {
        "name": "Location Navigation",
        "description": "Campus location finding and navigation system with floor maps, location matching, and direction guidance",
        "files": [
          "apps/client/src/locationMatcher.ts",
          "apps/client/src/locationsDatabase.ts",
          "apps/client/src/MapNavigator.tsx",
          "apps/server/src/index.ts"
        ]
      },
      {
        "name": "Staff Management",
        "description": "Staff directory, availability tracking, skill-based filtering, and staff profile management",
        "files": [
          "apps/server/src/routes/staff.ts",
          "apps/server/src/repositories/staffAvailabilityRepository.ts",
          "apps/staff/components/TeamDirectory.tsx",
          "apps/staff/components/Dashboard.tsx"
        ]
      },
      {
        "name": "Notification System",
        "description": "Real-time notification system with read/unread status, notification creation, and Socket.IO-based delivery",
        "files": [
          "apps/server/src/index.ts",
          "apps/staff/components/NotificationContainer.tsx",
          "apps/staff/components/NotificationProvider.tsx",
          "apps/staff/components/NotificationSync.tsx"
        ]
      },
      {
        "name": "College AI Assistant",
        "description": "AI-powered conversational assistant using Google Gemini AI for answering college-related queries, location finding, and general information",
        "files": [
          "apps/client/index.tsx",
          "apps/staff/components/AIChatAssistant.tsx",
          "apps/staff/services/geminiService.ts"
        ]
      },
      {
        "name": "Real-time Communication",
        "description": "Socket.IO-based real-time communication for call signaling, notifications, timetable updates, and WebRTC signaling",
        "files": [
          "apps/server/src/socket.ts",
          "apps/client/index.tsx",
          "apps/staff/components/Dashboard.tsx",
          "packages/shared/src/events.ts"
        ]
      },
      {
        "name": "Time & Schedule Utilities",
        "description": "Timezone-aware time utilities, schedule validation, availability calculations, and working hours management",
        "files": [
          "packages/shared-schedule/src/utils/time.ts",
          "packages/shared-schedule/src/utils/name-matching.ts",
          "packages/shared-schedule/src/availability.ts"
        ]
      },
      {
        "name": "Meeting & Task Management",
        "description": "Meeting scheduling, task management with localStorage persistence, and meeting summarization",
        "files": [
          "apps/staff/components/MeetingSummarizer.tsx",
          "apps/staff/components/TaskManagement.tsx",
          "apps/staff/components/DashboardHome.tsx"
        ]
      },
      {
        "name": "Call Store & State Management",
        "description": "Zustand-based state management for call state, call data, and call lifecycle",
        "files": [
          "apps/client/src/stores/callStore.ts",
          "apps/staff/src/stores/callStore.ts"
        ]
      },
      {
        "name": "Device Permission Management",
        "description": "Camera and microphone permission handling, device selection, and permission prompts",
        "files": [
          "apps/client/src/components/DevicePermissionPrompt.tsx",
          "apps/client/src/components/InCallControls.tsx"
        ]
      },
      {
        "name": "Error Handling & Logging",
        "description": "Comprehensive error handling, logging, and user feedback systems",
        "files": [
          "apps/server/src/index.ts",
          "apps/client/index.tsx",
          "apps/staff/components/ErrorBoundary.tsx"
        ]
      },
      {
        "name": "Rate Limiting & Security",
        "description": "Rate limiting for API endpoints, CORS configuration, and security measures",
        "files": [
          "apps/server/src/index.ts"
        ]
      },
      {
        "name": "Health Checks & Monitoring",
        "description": "Health check endpoints, server status monitoring, and diagnostic endpoints",
        "files": [
          "apps/server/src/index.ts",
          "apps/client/src/pages/diagnostics/audio-network.tsx"
        ]
      }
    ]
  }
}
